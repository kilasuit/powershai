---
external help file: powershai-help.xml
Module Name: powershai
online version:
schema: 2.0.0
---

# Update-GradioApiResult

## SYNOPSIS

## SYNTAX

```
Update-GradioApiResult [[-ApiEvent] <Object>] [-Script <Object>] [-MaxHeartBeats <Object>] [-NoOutput]
 [-History] [<CommonParameters>]
```

## DESCRIPTION
Updates an event returned by Send-GradioApi with new results from the server and, by default, returns the events in the pipeline.

Gradio API results are not generated instantly, as is the case with most REST HTTP services.

The help for the Send-GradioApi command explains in detail how the process works.

This command should be used to update the GradioApiEvent object returned by Send-GradioApi. This object represents the response of each call you make to the API; it contains everything needed to query the result, including data and history.

Basically, this cmdlet works by invoking the API invocation status query endpoint. The parameters needed for the query are available in the object itself passed in the -ApiEvent parameter (which is created and returned by the Send-GradioApi cmdlet).

Whenever this cmdlet executes, it communicates via a persistent HTTP connection with the server and waits for events.

As the server sends data, it updates the object passed in the -ApiEvent parameter, and by default, writes the returned event to the pipeline.

The returned event is an object of type GradioApiEventResult and represents an event generated by the API execution response.

If the -History parameter is specified, all generated events are stored in the events property of the object provided in -ApiEvent, as well as the returned data.

Basically, the generated events can send a heartbeat or data.

GradioApiEventResult OBJECT
	num 	= sequential event number.
starts at 1.
	ts 		= date when the event was created (local date, not server date).
	event 	= event name
	data 	= data returned in this event

DATA

	To get the data from Gradio, it is basically reading the events returned by this cmdlet and looking at the data property of the GradioApiEventResult. Generally, the Gradio interface overwrites the field with the last received event.

	If -History is used, in addition to writing to the pipeline, the cmdlet will store the data in the data field, and therefore, you will have access to the complete history of what was generated by the server.

	Note that this may cause additional memory consumption if many data are returned.

	There is a known "problematic" case: occasionally, Gradio may emit the last 2 events with the same data (1 event will have the name "generating," and the last will be complete).

	We still do not have a solution to separate this safely, and therefore, the user must decide the best way to handle it.

	If you always use the last received event, this is not a problem. If you need to use all events as they are generated, you will have to handle these cases. A simple example would be to compare the content; if they are the same, do not repeat. But there may be scenarios where 2 events with the same content are still logically different events.

HEARTBEAT 

	One of the events generated by the Gradio API is the Heartbeat.

	Every 15 seconds, Gradio sends a "HeartBeat" event just to keep the connection alive.

	This causes the cmdlet to "hang" because, as the HTTP connection is active, it waits for some response (which will be data, errors, or the heartbeat).

	If there is no control mechanism for this, the cmdlet would run indefinitely, with no possibility of canceling even with CTRL + C. To resolve this, this cmdlet provides the MaxHeartBeats parameter.

	This parameter indicates how many consecutive Heartbeat events will be tolerated before the cmdlet stops trying to query the API.

	For example, consider these two scenarios of events sent by the server:

		scenario 1:
			generating 
			heartbeat 
			generating 
			heartbeat 
			generating 
			complete
			
		scenario 2:
			generating 
			generating
			heartbeat 
			heartbeat
			heartbeat 
			complete

	Considering the default value, 2, in scenario 1, the cmdlet would never terminate before the complete, as there were never 2 consecutive heartbeats.

	In scenario 2, after receiving 2 data events (generating), on the fourth event (heartbeat), it would terminate because 2 consecutive heartbeats were sent.

	We say that the heartbeat expired in this case. In this case, you should invoke Update-GradioApiResult again to get the remainder.

	Whenever the command terminates due to the heartbeat expiring, it will update the value of the LastQueryStatus property to HeartBeatExpired.

	With this, you can check and handle correctly when to call again.

	
STREAM  

	Due to the fact that the Gradio API already responds using SSE (Server Side Events), it is possible to use an effect similar to "stream" from many APIs.

	This cmdlet, Update-GradioApiResult, already processes server events using SSE.

	Additionally, if you also want to do some processing as the event becomes available, you can use the -Script parameter and specify a script block, functions, etc. that will be invoked as soon as the event is received.

	Combining with the -MaxHeartBeats parameter, you can create a call that updates something in real-time. For example, if it is a response from a chatbot, it can write immediately to the screen.

	Note that this parameter is called in sequence with the code that checks (that is, the same Thread).

	Therefore, scripts that take too long may interfere with the detection of new events and consequently, the delivery of the data.
	
.

## EXAMPLES

### Example 1
```powershell
PS C:\> {{ Add example code here }}
```

{{ Add example description here }}

## PARAMETERS

### -ApiEvent
Result of Send-GradioApi

```yaml
Type: Object
Parameter Sets: (All)
Aliases:

Required: False
Position: 1
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
```

### -Script
script that will be invoked for each generated event!
Receives a hashtable with the following keys:
 	event - contains the generated event.
event.event is the name of the event.
event.data is the returned data.

```yaml
Type: Object
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -MaxHeartBeats
Max consecutive heartbeats until the stop!
Makes the command wait only for this number of consecutive heartbeats from the server.
When the server sends this quantity, the cmdlet terminates and sets the LastQueryStatus of the event to HeartBeatExpired.

```yaml
Type: Object
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -NoOutput
Does not write the result to the cmdlet output.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -History
Stores the history of events and data in the ApiEvent object.
Note that this will consume more memory in PowerShell!

```yaml
Type: SwitchParameter
Parameter Sets: (All)Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

## RELATED LINKS
```


_Automatically translated using PowershAI and AI._
