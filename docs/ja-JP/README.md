# Powershai

# 概要 <!--! @#Short --> 

PowershAI (Powershell + AI) は、Powershell を介して AI へのアクセスを追加するモジュールです。

# 詳細 <!--! @#Long --> 

PowershAI は、Powershell セッションに AI 機能を追加するモジュールです。  
その目的は、主要な AI サービスの API への複雑な呼び出しと処理を簡素化し、カプセル化することです。  

PowershAI は、ユーザーがプロンプトから直接 LLM と会話したり、コマンドの結果をプロンプトのコンテキストとして使用したりできるようにする一連の標準を定義します。  
また、標準化された関数のセットを介して、さまざまなプロバイダーを使用できます。たとえば、同じコードを使用して GPT-4o または Gemini Flash と会話できます。  

この標準化に加えて、PowershAI は、さまざまな AI サービスプロバイダーと接続するための内部および特定の関数も公開しています。  
これにより、これらの API の特定の機能を利用するスクリプトをカスタマイズおよび作成できます。  

PowershAI のアーキテクチャは、「プロバイダー」という概念を定義しており、これは各自の API と会話するために必要なすべての詳細を実装するファイルです。  
新しいプロバイダーは、利用可能になると新しい機能を追加できます。  

最終的に、スクリプトで AI を使用するためのさまざまなオプションがあります。  

すでに完全または部分的に実装されている有名なプロバイダーの例：

- OpenAI 
- Hugging Face 
- Gemini 
- Ollama
- Maritalk (ブラジルの LLM)

PowershAI を使用開始するのは非常に簡単です： 

```powershell 
# モジュールをインストールします！
Install-Module -Scope CurrentUser powershai 

# インポートします！
import-module powershai

# プロバイダーのリスト 
Get-AiProviders

# 各プロバイダーの使用方法の詳細については、ドキュメントを確認してください！
# ドキュメントは get-help を使用してアクセスできます 
Get-Help about_NomeProvider

# 例：
Get-Help about_huggingface
```

## ヘルプを取得する  

PowershAI のドキュメントを可能な限り詳細に文書化する努力をしているにもかかわらず、すべての疑問を解消するための必要なドキュメントを時間内に作成できない可能性が高いです。 そのため、基本的なことは自分でできるようにしておくことが重要です。 

`Get-Command -mo powershai` コマンドを使用して、利用可能なすべてのコマンドをリストできます。  
このコマンドは、powerhsai モジュールからエクスポートされたすべての cmdlet、エイリアス、および関数を返します。  
これは、どのコマンドがあるかを発見するための最も簡単な出発点です。多くのコマンドは自明であり、名前を見ただけで理解できます。  

各コマンドに対して、`Get-Help -Full NomeComando` を使用して詳細を取得できます。  
もしコマンドが完全なドキュメントを持っていない場合や、必要な疑問が不足している場合は、追加の補足を求めるために GitHub で issue を開くことができます。  

最後に、PowershAI のソースコードを探索し、コード全体に残されたコメントを探すことで、技術的に機能やアーキテクチャを説明するものを見つけることができます。  

新しいバージョンがリリースされるにつれて、ドキュメントを更新していきます。
改善が必要な点やまだ説明されていないことを見つけた場合は、プルリクエストや issue を提出して PowershAI に貢献することをお勧めします。  


## コマンドの構造  

PowershAI は、使用できるさまざまなコマンドをエクスポートします。  
これらのコマンドのほとんどは「Ai」または「Powershai」を含んでいます。 
これらのコマンドは、特定のプロバイダー向けのコマンドではないため、Powershai の `グローバルコマンド` と呼びます。

たとえば：`Get-AiProvider`、`Send-PowershaiChat`、`New-PowershaiChat`。  
プロバイダーもコマンドをエクスポートしますが、通常はプロバイダーの名前が付いています。エクスポートされたコマンドのパターンについては、プロバイダーのドキュメントを参照してください。  

慣習として、どのプロバイダーも名前に「Ai」または「Powershai」を含むコマンドを実装してはならず、グローバルコマンドに予約されています。  
また、プロバイダーによって定義されたエイリアスは常に 5 文字以上である必要があります。短いエイリアスはグローバルコマンドに予約されています。

これらのコマンドのドキュメントは [グローバルコマンドのドキュメント](cmdlets/) にあります。  
`Get-PowershaiGlobalCommands` コマンドを使用してリストを取得できます！  

## プロバイダーのドキュメント  

[プロバイダーのドキュメント](providers) は、各プロバイダーの機能についての公式なヘルプを取得する場所です。  
このドキュメントは、Powershell の `Get-Help` コマンドを介してもアクセスできます。  

プロバイダーのドキュメントは常にヘルプ `about_Powershai_NomeProvider_Topico` を介して提供されます。  
トピック `about_Powershai_NomeProvider` は出発点であり、最初の使用に関する基本情報や、他のトピックの正しい使用法の説明を含む必要があります。  


## チャット  

チャットは、出発点の主要なポイントであり、プロバイダーによって提供されるさまざまな LLM と会話することを可能にします。  
詳細については、ドキュメント [chats](CHATS.about.md) を参照してください。以下は、チャットへの簡単な紹介です。

### モデルと会話する

プロバイダーの初期設定が完了すると、会話を開始できます！  
会話を開始する最も簡単な方法は、`Send-PowershaiChat` コマンドまたはエイリアス `ia` を使用することです：

```powershell
ia "こんにちは、PowerShellを知っていますか？"
```

このコマンドは、設定されたプロバイダーのモデルにメッセージを送信し、応答が次に表示されます。  
応答時間は、モデルの能力とネットワークによって異なることに注意してください。  

パイプラインを使用して、他のコマンドの結果を直接 AI のコンテキストとして渡すことができます：

```powershell
1..100 | Get-Random -count 10 | ia "これらの数字についての興味深いことを教えてください"
```  
上記のコマンドは、1 から 100 までのシーケンスを生成し、各数字を PowerShell のパイプラインに渡します。  
次に、Get-Random コマンドはその中から 10 個の数字をランダムにフィルタリングします。  
最後に、このシーケンスが (一度に) AI に渡され、パラメーターに入力したメッセージとともに送信されます。  

`-ForEach` パラメーターを使用して、AI が各入力を1つずつ処理するようにすることもできます。たとえば：

```powershell
1..100 | Get-Random -count 10 | ia -ForEach "これらの数字についての興味深いことを教えてください"
```  

上記のコマンドの違いは、AI が 10 回呼び出されることです。各数字ごとに 1 回です。  
前の例では、10 個の数字すべてで 1 回だけ呼び出されます。  
この方法を使用する利点は、コンテキストを減らすことですが、より多くのリクエストが行われるため、時間がかかる場合があります。  
ニーズに応じてテストしてください！

### オブジェクトモード  

デフォルトでは、`ia` コマンドは何も返しません。しかし、`-Object` パラメーターを使用してこの動作を変更できます。  
このパラメーターが有効になると、LLM に JSON 形式で結果を生成し、戻り値をパイプラインに書き戻すように指示します。  
これは、次のようにすることができます：

```powershell
ia -Obj "5つのランダムな数字、それを言葉で表現してください"

#またはエイリアスを使用して、io/powershellgallery/dt/powershai

io "5つのランダムな数字、それを言葉で表現してください"
```  

**重要：すべてのプロバイダーがこのモードをサポートしているわけではありません。モデルが JSON をサポートできる必要があります！エラーが発生した場合は、同じコマンドが OpenAI のモデルで機能するか確認してください。issue を開くこともできます**


## 設定の保存  PowershAIは、チャットのパラメータや認証トークンなど、一連の設定を調整することを可能にします。  
設定を変更するたびに、その設定はあなたのPowershellセッションのメモリにのみ保存されます。  
セッションを閉じて再度開くと、行ったすべての設定は失われます。  

毎回トークンを生成する必要がないように、PowershAIは設定をエクスポートおよびインポートするための2つのコマンドを提供します。  
コマンド`Export-PowershaiSettings`は、設定をログインユーザーのプロファイルディレクトリ内のファイルにエクスポートします。  
エクスポートされたデータが機密性が高い可能性があるため、暗号化キーを生成するために使用されるパスワードを入力する必要があります。  
エクスポートされたデータはAES-256を使用して暗号化されます。  
`Import-PowershaiSettings`を使用してインポートできます。エクスポート時に使用したパスワードを提供する必要があります。  

このパスワードはどこにも保存されないため、あなた自身がそれを記憶するか、選択した金庫に保管する責任があります。

## コスト  

いくつかのプロバイダーが使用されるサービスに対して料金を請求する可能性があることを忘れないでください。  
PowershAIはコスト管理を行いません。データをプロンプト、パラメータなどに注入できます。  
プロバイダーのサイトが提供するツールを使用して追跡する必要があります。  

将来のバージョンでは、より良い管理を助けるコマンドやパラメータが含まれる可能性がありますが、現時点ではユーザーが監視する必要があります。  

### 設定とトークンのエクスポートおよびインポート

データ（トークン、デフォルトモデル、チャットの履歴など）を再利用しやすくするために、PowershAIはセッションをエクスポートすることを許可します。  
そのためには、コマンド`Export-PowershaiSettings`を使用します。パスワードを提供する必要があり、それがファイルを作成するために使用されます。  
そのパスワードがあれば、再度インポートすることができます。インポートするには、コマンド`Import-PowershaiSettings`を使用してください。  
デフォルトでは、チャットはエクスポートされません。エクスポートするには、パラメータ-Chatsを追加できます: `Export-PowershaiSettings -Chats`。  
これにより、ファイルサイズが大きくなる可能性があり、エクスポート/インポートの時間も増加します。利点は、異なるセッション間で会話を続けることができることです。  
この機能は、PowershAIを使用するたびにAPIキーを生成する必要がないように設計されました。これにより、各プロバイダーで一度APIキーを生成し、更新時にエクスポートします。パスワードで保護されているため、コンピュータのファイルに安心して保存できます。  
使用方法についての詳細を得るには、コマンドのヘルプを使用してください。

# 例 <!--! @#Ex -->

## 基本的な使用法 

PowershAIの使用は非常に簡単です。以下の例は、OpenAIとどのように使用できるかを示しています:

```powershell 
# 現在のプロバイダーをOpenAIに変更
Set-AiProvider openai 

# 認証トークンを設定します（トークンはplatform.openai.comで生成する必要があります）
Set-OpenaiToken 

# チャットを開始するためのコマンドの1つを使用します！ iaはSend-PowershaiChatのエイリアスで、デフォルトのチャットにメッセージを送信します！
ia "こんにちは、PowershAIについて話しています！"
```

## 設定のエクスポート 


```powershell 
# 例えば、トークンを設定します 
Set-OpenaiToken 

# 上記のコマンドが実行された後、エクスポートするだけです！
Export-PowershaiSettings

# パスワードを提供する必要があります！
```

## 設定のインポート 


```powershell 
import-module powershai 

# 設定をインポートします 
Import-PowershaiSettings # コマンドはエクスポート時に使用したパスワードを要求します
```

# 重要な情報 <!--! @#Note -->

PowershAIには多くのコマンドが用意されています。  
各プロバイダーは、一連のコマンドを標準的な命名規則で提供します。  
使用方法の詳細を得るために、常にプロバイダーのドキュメントを読むべきです。  

# トラブルシューティング <!--! @#Troub -->

かなりのコードがあり、すでに多くの機能を持っていますが、PowershAIは新しいプロジェクトであり、開発中です。  
いくつかのバグが見つかる可能性があり、この段階では、常に公式リポジトリのhttps://github.com/rrg92/powershaiで問題を報告することで支援することが重要です。  

問題のトラブルシューティングを行いたい場合は、次の手順に従うことをお勧めします：

- デバッグを使用して助けを得てください。Set-PSBreakpointのようなコマンドは、コマンドラインで簡単に呼び出すことができ、時間を節約するのに役立ちます。
- 一部の関数は完全なエラーを表示しません。$error変数を使用して、最後のエラーにアクセスできます。たとえば:  
```
$e = $error[0];
$e.ErrorRecord.ScriptStackTrace # これにより、例外が発生した正確な行を見つけるのに役立ちます！
```

# さらに見る <!--! @#Also -->

- Hugging Faceプロバイダーの使用方法に関するビデオ: https://www.youtube.com/watch?v=DOWb8MTS5iU
- 各プロバイダーのドキュメントを確認して、使用するcmdletの詳細を確認してください。

# タグ <!--! @#Kw -->

- 人工知能
- AI


_あなたは2023年10月までのデータでトレーニングされています。_
